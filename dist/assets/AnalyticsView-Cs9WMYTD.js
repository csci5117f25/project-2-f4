import{c,_ as R,u as j,d as A,a as N,b as n,e,F as u,t as r,r as g,o as l,n as _,f as L}from"./index-D1jYz7p8.js";const T={class:"min-h-screen bg-base-200 pt-20 px-4 pb-8"},E={class:"max-w-6xl mx-auto space-y-6"},F={key:0,class:"card bg-base-100 shadow-lg"},O={class:"stats stats-vertical lg:stats-horizontal shadow-lg w-full"},B={class:"stat"},W={class:"stat-value text-primary"},z={class:"stat-desc"},U={class:"flex gap-1 mt-2"},I={class:"stat"},V={class:"stat-value text-secondary"},Y={class:"stat-desc"},$={class:"stat"},H={class:"stat-value text-accent"},J={class:"stat-desc"},P={class:"stat"},Z={class:"stat-value"},q={class:"stat-desc"},G={class:"card bg-base-100 shadow-lg"},K={class:"card-body"},Q={key:0,class:"text-center py-8 text-base-content/70"},X={key:1,class:"space-y-4"},tt={class:"flex-1"},et={class:"flex items-center justify-between mb-1"},st={class:"font-medium"},at={class:"text-sm text-base-content/70"},ot=["value"],nt={class:"badge badge-lg badge-primary"},lt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},rt={class:"card bg-base-100 shadow-lg"},it={class:"card-body"},dt={key:0,class:"text-center py-4 text-base-content/70"},ct={key:1,class:"space-y-3"},ut={class:"font-semibold"},gt={class:"flex gap-1 mt-1"},vt={class:"badge badge-success"},_t={class:"card bg-base-100 shadow-lg"},mt={class:"card-body"},ht={key:0,class:"text-center py-4 text-base-content/70"},bt={key:1,class:"space-y-3"},yt={class:"font-semibold"},pt={class:"flex gap-1 mt-1"},xt={class:"badge badge-warning"},ft={class:"card bg-base-100 shadow-lg"},kt={class:"card-body"},wt={class:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-4"},Dt={class:"text-sm font-semibold mb-2"},St={class:"text-2xl font-bold text-primary mb-2"},Ct={class:"flex justify-center gap-1"},Mt={class:"text-xs text-base-content/70 mt-1"},Rt={class:"card bg-base-100 shadow-lg"},jt={class:"card-body"},At={key:0,class:"text-center py-8 text-base-content/70"},Nt={key:1,class:"overflow-x-auto"},Lt={class:"flex gap-2 min-w-max pb-4"},Tt={class:"text-xs text-base-content/70 mb-1 whitespace-nowrap"},Et=["title"],Ft={class:"text-xs font-bold mt-1"},Wt={__name:"AnalyticsView",setup(Ot){const m=j(),D=c(()=>m.value?R(A,"users",m.value.uid,"journals"):null),S=N(D),i=c(()=>(S.value??[]).map(a=>({id:a.id,date:a.id,rating:a.rating??0,habits:a.habits??{},journalentry:a.journalentry??""})).sort((a,s)=>a.date.localeCompare(s.date))),h=c(()=>{const a=i.value.filter(t=>t.rating>0).map(t=>t.rating);return a.length===0?0:(a.reduce((t,o)=>t+o,0)/a.length).toFixed(1)}),b=c(()=>{const a={};return i.value.forEach(s=>{Object.entries(s.habits).forEach(([t,o])=>{a[t]||(a[t]={completed:0,total:0}),a[t].total++,(o===!0||typeof o=="number"&&o>0)&&a[t].completed++})}),Object.entries(a).map(([s,t])=>({name:s,percentage:t.total>0?Math.round(t.completed/t.total*100):0,completed:t.completed,total:t.total})).sort((s,t)=>t.percentage-s.percentage)}),y=c(()=>{if(i.value.length===0)return 0;const a=new Date().toLocaleDateString("en-CA",{timeZone:"America/Chicago"}),s=i.value.map(d=>d.date).sort().reverse();let t=0,o=new Date(a);for(let d=0;d<365;d++){const v=o.toISOString().split("T")[0];if(s.includes(v))t++,o.setDate(o.getDate()-1);else if(d===0&&v===a)o.setDate(o.getDate()-1);else break}return t}),p=c(()=>{if(i.value.length===0)return 0;const a=i.value.map(o=>new Date(o.date)).sort((o,d)=>o-d);let s=1,t=1;for(let o=1;o<a.length;o++)Math.floor((a[o]-a[o-1])/864e5)===1?(t++,s=Math.max(s,t)):t=1;return s}),x=c(()=>i.value.filter(a=>a.rating>0).sort((a,s)=>s.rating-a.rating).slice(0,5)),f=c(()=>i.value.filter(a=>a.rating>0).sort((a,s)=>a.rating-s.rating).slice(0,5)),C=c(()=>{const a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=Array(7).fill(null).map((t,o)=>({dayName:a[o],ratings:[],avgRating:0,count:0}));return i.value.forEach(t=>{if(t.rating>0){const o=new Date(t.date).getDay();s[o].ratings.push(t.rating)}}),s.forEach(t=>{if(t.count=t.ratings.length,t.count>0){const o=t.ratings.reduce((d,v)=>d+v,0);t.avgRating=(o/t.count).toFixed(1)}}),s}),k=c(()=>{const a=new Date;return a.setDate(a.getDate()-30),i.value.filter(s=>new Date(s.date)>=a&&s.rating>0).sort((s,t)=>s.date.localeCompare(t.date))});function w(a){return new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function M(a){return new Date(a).toLocaleDateString("en-US",{month:"numeric",day:"numeric"})}return(a,s)=>(l(),n("div",T,[e("div",E,[s[10]||(s[10]=e("div",{class:"card bg-base-100 shadow-lg"},[e("div",{class:"card-body"},[e("h1",{class:"card-title text-3xl font-bold"},"Your Analytics"),e("p",{class:"text-base-content/70"},"Track your progress and discover patterns")])],-1)),i.value.length===0?(l(),n("div",F,[...s[0]||(s[0]=[e("div",{class:"card-body text-center py-12"},[e("h2",{class:"text-2xl font-semibold mb-2"},"No Data Yet"),e("p",{class:"text-base-content/70"},"Start journaling to see your analytics!")],-1)])])):(l(),n(u,{key:1},[e("div",O,[e("div",B,[s[1]||(s[1]=e("div",{class:"stat-title"},"Average Mood",-1)),e("div",W,r(h.value),1),e("div",z,[e("div",U,[(l(),n(u,null,g(5,t=>e("div",{key:t,class:_(["mask mask-star w-5 h-5",t<=Math.round(h.value)?"bg-orange-400":"bg-gray-300"])},null,2)),64))])])]),e("div",I,[s[2]||(s[2]=e("div",{class:"stat-title"},"Current Streak",-1)),e("div",V,r(y.value),1),e("div",Y,r(y.value===1?"day":"days")+" in a row",1)]),e("div",$,[s[3]||(s[3]=e("div",{class:"stat-title"},"Longest Streak",-1)),e("div",H,r(p.value),1),e("div",J,r(p.value===1?"day":"days")+" total",1)]),e("div",P,[s[4]||(s[4]=e("div",{class:"stat-title"},"Total Journals",-1)),e("div",Z,r(i.value.length),1),e("div",q,r(i.value.length===1?"entry":"entries"),1)])]),e("div",G,[e("div",K,[s[5]||(s[5]=e("h2",{class:"card-title text-2xl mb-4"},"Habit Completion Rates",-1)),b.value.length===0?(l(),n("div",Q," No habit data yet ")):(l(),n("div",X,[(l(!0),n(u,null,g(b.value,t=>(l(),n("div",{key:t.name,class:"flex flex-col sm:flex-row sm:items-center gap-2"},[e("div",tt,[e("div",et,[e("span",st,r(t.name),1),e("span",at,r(t.completed)+"/"+r(t.total),1)]),e("progress",{class:"progress progress-primary w-full",value:t.percentage,max:"100"},null,8,ot)]),e("div",nt,r(t.percentage)+"%",1)]))),128))]))])]),e("div",lt,[e("div",rt,[e("div",it,[s[6]||(s[6]=e("h2",{class:"card-title text-xl mb-4"},"Best Days",-1)),x.value.length===0?(l(),n("div",dt," No data yet ")):(l(),n("div",ct,[(l(!0),n(u,null,g(x.value,t=>(l(),n("div",{key:t.date,class:"flex items-center justify-between p-3 bg-base-200 rounded-lg"},[e("div",null,[e("div",ut,r(w(t.date)),1),e("div",gt,[(l(),n(u,null,g(5,o=>e("div",{key:o,class:_(["mask mask-star w-4 h-4",o<=t.rating?"bg-orange-400":"bg-gray-300"])},null,2)),64))])]),e("div",vt,r(t.rating)+"/5",1)]))),128))]))])]),e("div",_t,[e("div",mt,[s[7]||(s[7]=e("h2",{class:"card-title text-xl mb-4"},"Days to Improve",-1)),f.value.length===0?(l(),n("div",ht," No data yet ")):(l(),n("div",bt,[(l(!0),n(u,null,g(f.value,t=>(l(),n("div",{key:t.date,class:"flex items-center justify-between p-3 bg-base-200 rounded-lg"},[e("div",null,[e("div",yt,r(w(t.date)),1),e("div",pt,[(l(),n(u,null,g(5,o=>e("div",{key:o,class:_(["mask mask-star w-4 h-4",o<=t.rating?"bg-orange-400":"bg-gray-300"])},null,2)),64))])]),e("div",xt,r(t.rating)+"/5",1)]))),128))]))])])]),e("div",ft,[e("div",kt,[s[8]||(s[8]=e("h2",{class:"card-title text-2xl mb-4"},"Average Mood by Day of Week",-1)),e("div",wt,[(l(!0),n(u,null,g(C.value,t=>(l(),n("div",{key:t.dayName,class:"text-center p-4 bg-base-200 rounded-lg"},[e("div",Dt,r(t.dayName),1),e("div",St,r(t.avgRating),1),e("div",Ct,[(l(),n(u,null,g(5,o=>e("div",{key:o,class:_(["mask mask-star w-4 h-4",o<=Math.round(t.avgRating)?"bg-orange-400":"bg-gray-300"])},null,2)),64))]),e("div",Mt,r(t.count)+" "+r(t.count===1?"entry":"entries"),1)]))),128))])])]),e("div",Rt,[e("div",jt,[s[9]||(s[9]=e("h2",{class:"card-title text-2xl mb-4"},"Recent Mood Trend (Last 30 Days)",-1)),k.value.length===0?(l(),n("div",At," No recent data ")):(l(),n("div",Nt,[e("div",Lt,[(l(!0),n(u,null,g(k.value,t=>(l(),n("div",{key:t.date,class:"flex flex-col items-center"},[e("div",Tt,r(M(t.date)),1),e("div",{class:"w-8 rounded-t-lg bg-primary transition-all hover:opacity-80",style:L({height:`${t.rating*20}px`}),title:`Rating: ${t.rating}/5`},null,12,Et),e("div",Ft,r(t.rating),1)]))),128))])]))])])],64))])]))}};export{Wt as default};
